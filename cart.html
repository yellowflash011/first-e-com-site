<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Cart</title>
    <link
      rel="stylesheet"
      href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css"
    />

    <link rel="stylesheet" href="style.css" />
  </head>

  <body>
    <section id="header">
      <a class="header-img" href="">
        <img src="img/logo.png" class="logo" alt="LOGO" />
      </a>
      <div>
        <ul id="navbar">
          <li><a href="index.html">HOME</a></li>
          <li><a href="shop.html">SHOP</a></li>
          <li>
            <a id="lg-bag" href="cart.html " class="active"
              ><i class="fa fa-shopping-cart"></i>
            </a>
          </li>
          <a href="#" id="close">
            <i class="far fa-times"></i>
          </a>
        </ul>
      </div>
      <div id="mobile">
        <a href="cart.html"><i class="far fa-shopping-bag"></i></a>
        <i id="bar" class="fas fa-outdent"></i>
      </div>
    </section>

    <section id="cart" class="section-p1">
      <table width="100%">
        <thead>
          <tr>
            <td>Remove</td>
            <td>Image</td>
            <td>Product</td>
            <td>Price</td>
            <td>Quantity</td>
            <td>Memory</td>
            <td>Subtotal</td>
          </tr>
        </thead>
        <tbody id="cart-items">
          <!-- Cart items will be dynamically added here -->
        </tbody>
      </table>
    </section>
    <section id="cart" class="section-p1">...</section>

    <section id="cart-add" class="section-p1">
      <div id="coupon">
        <h3>Apply Coupon</h3>
        <div>
          <input type="text" placeholder="Enter Your Coupon" />
          <button class="normal">Apply</button>
        </div>
      </div>
      <div id="subtotal">
        <h3>Cart Totals</h3>
        <table>
          <tr>
            <td>Cart Subtotal</td>
            <td id="cart-subtotal">$0</td>
          </tr>
          <tr>
            <td>Shipping</td>
            <td>Free</td>
          </tr>
          <tr>
            <td><strong>Total</strong></td>
            <td><strong id="cart-total">$0</strong></td>
          </tr>
        </table>
        <button class="normal">Proceed to Checkout</button>
      </div>
    </section>

    <footer class="section-p1">
      <div class="col">
        <img src="img/logo.png" alt="" id="imgg" />
        <h4>Contact</h4>
        <p>
          <strong>Address: </strong> 562 Wellington Road, Street 32, San
          Francisco
        </p>
        <p><strong>Phone: </strong> +01 2222 365 / (+91) 01 2345 6789</p>
        <p><strong>Hours: </strong> 10:00 - 18:00, Mon - Sat</p>
        <div class="follow">
          <h4>Follow us</h4>
          <div class="icon">
            <i class="fab fa-facebook-f"></i>
            <i class="fab fa-twitter"></i>
            <i class="fab fa-instagram"></i>
            <i class="fab fa-pinterest-p"></i>
            <i class="fab fa-youtube"></i>
          </div>
        </div>
      </div>
      <div class="col">
        <h4>About</h4>
        <a href="#">About us</a>
        <a href="#">Delivery Information</a>
        <a href="#">Privacy Policy</a>
        <a href="#">Terms & Conditions</a>
        <a href="#">Contact Us</a>
      </div>
      <div class="col">
        <h4>My Account</h4>
        <a href="#">Sign In</a>
        <a href="#">View Cart</a>
        <a href="#">My Wishlist</a>
        <a href="#">Track My Order</a>
        <a href="#">Help</a>
      </div>
      <div class="col install">
        <h4>Install App</h4>
        <p>From App Store or Google Play</p>
        <div class="row">
          <img class="logo" src="img/pay/app.jpg" alt="" />
          <img src="img/pay/play.jpg" alt="" />
        </div>
        <p>Secured Payment Gateways</p>
        <img src="img/pay/pay.png" alt="" />
      </div>

      <div class="copyright">
        <p>Â© 2025 Hussain Nazir Works. All Right Reserved</p>
      </div>
    </footer>
    <script>
      function displayCart() {
        let cart;
        try {
          cart = JSON.parse(localStorage.getItem("cart")) || [];
        } catch (error) {
          console.error("Error parsing cart from localStorage:", error);
          cart = [];
        }
        const cartItemsContainer = document.getElementById("cart-items");
        if (!cartItemsContainer) {
          console.error("Cart items container (#cart-items) not found in DOM");
          return;
        }
        cartItemsContainer.innerHTML = "";
        if (!cart.length) {
          cartItemsContainer.innerHTML =
            '<tr><td colspan="7">Your cart is empty</td></tr>';
          document.getElementById("cart-subtotal").textContent = "$0.00";
          document.getElementById("cart-total").textContent = "$0.00";
          console.log("Cart is empty");
          return;
        }
        let subtotal = 0;
        cart.forEach((item) => {
          try {
            const price =
              typeof item.price === "string"
                ? parseFloat(item.price.replace("$", "")) || 0
                : item.price;
            const row = document.createElement("tr");
            const cells = [
              `<a href="#" onclick="removeItem('${item.id}', '${
                item.memory || ""
              }')"><i class="far fa-times-circle"></i></a>`,
              `<img src="${item.image || ""}" alt="${
                item.name || "Unknown"
              }" />`,
              item.name || "Unknown Product",
              `$${price.toFixed(2)}`,
              `<input type="number" value="${
                item.quantity || 1
              }" min="1" onchange="updateQuantity('${item.id}', '${
                item.memory || ""
              }', this.value)" />`,
              item.memory || "N/A",
              `$${(item.quantity * price).toFixed(2)}`,
            ];
            cells.forEach((cell) => {
              const td = document.createElement("td");
              if (typeof cell === "string" && cell.startsWith("<")) {
                td.innerHTML = cell;
              } else {
                td.textContent = cell;
              }
              row.appendChild(td);
            });
            cartItemsContainer.appendChild(row);
            subtotal += (item.quantity || 1) * price;
          } catch (error) {
            console.error(`Error rendering cart item ${item.id}:`, error);
          }
        });
        const shipping = 0;
        const total = subtotal + shipping;
        document.getElementById(
          "cart-subtotal"
        ).textContent = `$${subtotal.toFixed(2)}`;
        document.getElementById("cart-total").textContent = `$${total.toFixed(
          2
        )}`;
        console.log("Cart rendered with", cart.length, "items");
      }

      function removeItem(productId, memory) {
        try {
          let cart = JSON.parse(localStorage.getItem("cart")) || [];
          cart = cart.filter(
            (item) => !(item.id === productId && (item.memory || "") === memory)
          );
          localStorage.setItem("cart", JSON.stringify(cart));
          displayCart();
          console.log(
            `Removed item ${productId} with memory ${memory || "N/A"}`
          );
        } catch (error) {
          console.error("Error removing item:", error);
        }
      }

      function updateQuantity(productId, memory, newQuantity) {
        try {
          let cart = JSON.parse(localStorage.getItem("cart")) || [];
          const item = cart.find(
            (item) => item.id === productId && (item.memory || "") === memory
          );
          if (item) {
            item.quantity = Math.max(1, parseInt(newQuantity)) || 1;
            localStorage.setItem("cart", JSON.stringify(cart));
            displayCart();
            console.log(
              `Updated quantity for ${productId} (${memory || "N/A"}) to ${
                item.quantity
              }`
            );
          } else {
            console.warn(
              `Item ${productId} with memory ${
                memory || "N/A"
              } not found in cart`
            );
          }
        } catch (error) {
          console.error("Error updating quantity:", error);
        }
      }

      window.onload = function () {
        try {
          displayCart();
        } catch (error) {
          console.error("Error initializing cart display:", error);
        }
      };
    </script>
    <script src="script.js"></script>
  </body>
</html>
